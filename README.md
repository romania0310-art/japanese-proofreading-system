# 日本語校正システム - フォーマット保持対応

## プロジェクト概要
- **名前**: 日本語校正システム
- **技術スタック**: JavaScript + JSZip + XLSX + DOCX
- **目標**: あゆみ表記ルール・文化審議会『公用文作成の考え方』準拠の日本語文書校正
- **特徴**: **完全なフォーマット保持、表構造保持、181の校正ルール適用**

## 🌐 アクセス可能URL
**https://3001-irt42n8t2ty9vl4jwuono-6532622b.e2b.dev**

## 現在実装済みの機能

### ✅ コア機能
1. **文書解析エンジン**
   - DOCXファイル解析（表構造完全保持）
   - **XLSXファイル解析** ⭐ **v1.2.0 - 体裁保持対応完了**
   - TXT/CSVファイル対応
   - マルチエンコーディング対応

2. **校正エンジン**
   - 181個のあゆみ表記ルール適用
   - パターンマッチング校正
   - 変更箇所の詳細記録

3. **🔥 フォーマット保持ダウンロード機能** ⭐ **v1.2.0 完全対応**
   - 校正後DOCXファイル生成（XMLレベル校正）
   - **校正後XLSXファイル生成（書式完全保持）** ⭐ **NEW**
   - 元の表構造・レイアウト・スタイル完全保持
   - ファイル名自動付与（「_校正済み.docx/xlsx」）
   - 複数シート対応・セルスタイル保持

4. **Web UI** ⭐ **v1.2.0 UI改善完了**
   - ドラッグ&ドロップファイルアップロード
   - **ファイル削除/クリアボタン** ⭐ **NEW**
   - リアルタイム処理進捗表示
   - 校正結果表示（統計・変更一覧）
   - **「推敲後の文章」プレビュー廃止** （不要機能除去）
   - テキストコピー機能
   - **元の形式でダウンロード（DOCX/XLSX対応）** ⭐ **NEW**

### 📋 API エンドポイント
- `GET /` - メインページ
- `GET /api/health` - ヘルスチェック
- `POST /api/parse` - ファイル解析
- `POST /api/proofread` - 文章校正
- **`POST /api/generate-docx`** - 校正後DOCX/XLSX生成・ダウンロード ⭐ **v1.2.0 XLSX対応**

### 💾 データ構造
- **校正ルール**: 181ルール（あゆみ表記準拠）
- **メタデータ**: 表数、段落数、文字数
- **変更記録**: 位置、原文、修正文、適用ルール
- **フォーマット情報**: XML構造、スタイル、レイアウト ⭐ **NEW**

## 簡単な使用方法

### 🚀 ローカル実行
```bash
# 依存関係インストール
npm install

# サーバー起動
npm start
# または
pm2 start ecosystem.config.cjs

# アクセス
http://localhost:3001
```

### 📁 使用手順
1. Webページでファイル選択（DOCX/XLSX/TXT/CSV）
2. 「解析・校正実行」ボタンクリック
3. 校正結果を確認（統計情報・変更一覧）
4. **「元の形式でダウンロード」で体裁保持した校正済み文書を取得** ⭐ **DOCX/XLSX完全対応**
5. またはテキストコピーで内容をクリップボードにコピー
6. **不要なファイルは「削除」ボタンで簡単クリア** ⭐ **NEW**

## デプロイメント情報

### 🌐 システムの利点
- **安定性**: サーバーサイド処理による高い安定性
- **フォーマット保持**: 完全なDOCX/XLSX構造保持 ⭐ **最大の特徴**
- **柔軟性**: フル機能APIによる高度な処理
- **デバッグ性**: 詳細なログ出力
- **拡張性**: 豊富なライブラリエコシステム

### 📦 デプロイオプション
1. **Vercel** (推奨)
   - ゼロコンフィグデプロイ
   - 自動HTTPS
   - グローバルCDN

2. **Railway**
   - 簡単デプロイ
   - 永続ストレージ
   - 自動スケーリング

3. **Heroku**
   - 老舗PaaS
   - アドオン豊富
   - 実績十分

### 🔧 現在のステータス
- **ローカル開発**: ✅ 完了
- **コア機能**: ✅ 動作確認済み  
- **フォーマット保持**: ✅ **新規実装完了** ⭐
- **XLSX対応**: ✅ **v1.2.0 完全実装** ⭐
- **UI/UX**: ✅ 実装済み
- **デプロイ準備**: ✅ **完了** ⭐ (Vercel/Railway/Render対応)

## 実装されていない機能
- オンライン永続化（ファイル保存）
- ユーザー認証システム
- 複数ファイル同時処理
- カスタム校正ルール追加
- Excel/PowerPointファイルサポート

## 🚀 デプロイ手順（準備完了）

### 推奨デプロイサービス
1. **Vercel** (最推奨) - `vercel.json`設定済み
2. **Railway** - `railway.toml`設定済み  
3. **Render** - Node.js対応
4. **Netlify** - `netlify.toml`設定済み

### デプロイ手順
詳細は `DEPLOYMENT.md` を参照してください。

## 推奨される次のステップ
1. ✅ **本格デプロイ**: Vercel/Railway/Renderで即座にデプロイ可能
2. カスタムドメイン設定
3. 校正ルールのカスタマイズ機能追加
4. PowerPointファイル対応の追加
5. ユーザー認証システムの追加

## 🎯 主要な改善点（v1.2.0）
- ✅ **XLSX体裁保持対応**: セルスタイル、書式、列幅を完全保持
- ✅ **統合ダウンロード機能**: DOCX/XLSX両形式に対応した校正ファイル生成
- ✅ **UI/UX改善**: 不要なプレビューエリア削除、ファイル削除ボタン追加
- ✅ **スプレッドシート校正**: 複数シート、数式、書式を保持しながら校正適用
- ✅ **完全な体裁保持**: XMLレベル（DOCX）とワークブックレベル（XLSX）での精密処理

## 最終更新
- **日付**: 2025-09-08  
- **バージョン**: 1.2.0
- **ステータス**: XLSX体裁保持機能完全実装、UI改善完了
- **テスト済み**: 
  - トンガ王国大使セレモニー文書（DOCX: 437KB、6表、151段落）
  - 校正テスト用スプレッドシート（XLSX: 17KB、3列8行、書式保持）