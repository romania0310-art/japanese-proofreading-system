# 日本語校正システム (GitHub版) - フォーマット保持対応

## プロジェクト概要
- **名前**: 日本語校正システム (GitHub版)
- **技術スタック**: Node.js + Express + JSZip + DOCX
- **目標**: あゆみ表記ルール・文化審議会『公用文作成の考え方』準拠の日本語文書校正
- **特徴**: **完全なフォーマット保持、表構造保持、181の校正ルール適用**

## 🌐 アクセス可能URL
**https://3001-irt42n8t2ty9vl4jwuono-6532622b.e2b.dev**

## 現在実装済みの機能

### ✅ コア機能
1. **文書解析エンジン**
   - DOCXファイル解析（表構造完全保持）
   - XLSXファイル解析  
   - TXT/CSVファイル対応
   - マルチエンコーディング対応

2. **校正エンジン**
   - 181個のあゆみ表記ルール適用
   - パターンマッチング校正
   - 変更箇所の詳細記録

3. **🔥 フォーマット保持ダウンロード機能** ⭐ **NEW**
   - 校正後DOCXファイル生成
   - 元の表構造・レイアウト完全保持
   - ファイル名自動付与（「_校正済み.docx」）
   - XMLレベルでの精密な校正適用

4. **Web UI**
   - ドラッグ&ドロップファイルアップロード
   - リアルタイム処理進捗表示
   - 校正結果表示（統計・変更一覧）
   - テキストコピー機能
   - **DOCXダウンロードボタン** ⭐ **NEW**

### 📋 API エンドポイント
- `GET /` - メインページ
- `GET /api/health` - ヘルスチェック
- `POST /api/parse` - ファイル解析
- `POST /api/proofread` - 文章校正
- **`POST /api/generate-docx`** - 校正後DOCX生成・ダウンロード ⭐ **NEW**

### 💾 データ構造
- **校正ルール**: 181ルール（あゆみ表記準拠）
- **メタデータ**: 表数、段落数、文字数
- **変更記録**: 位置、原文、修正文、適用ルール
- **フォーマット情報**: XML構造、スタイル、レイアウト ⭐ **NEW**

## 簡単な使用方法

### 🚀 ローカル実行
```bash
# 依存関係インストール
npm install

# サーバー起動
npm start
# または
pm2 start ecosystem.config.cjs

# アクセス
http://localhost:3001
```

### 📁 使用手順
1. Webページでファイル選択（DOCX/XLSX/TXT/CSV）
2. 「解析・校正実行」ボタンクリック
3. 校正結果を確認（統計情報・変更一覧）
4. **「DOCXダウンロード」でフォーマット保持した校正済み文書を取得** ⭐ **重要機能**
5. またはテキストコピーで内容をクリップボードにコピー

## デプロイメント情報

### 🌐 GitHub版の利点
- **安定性**: Cloudflare Workersの制約なし
- **フォーマット保持**: 完全なDOCX構造保持 ⭐ **最大の特徴**
- **柔軟性**: Node.js標準APIフル活用
- **デバッグ性**: サーバーログ完全取得
- **拡張性**: 追加ライブラリ自由導入

### 📦 デプロイオプション
1. **Vercel** (推奨)
   - ゼロコンフィグデプロイ
   - 自動HTTPS
   - グローバルCDN

2. **Railway**
   - 簡単デプロイ
   - 永続ストレージ
   - 自動スケーリング

3. **Heroku**
   - 老舗PaaS
   - アドオン豊富
   - 実績十分

### 🔧 現在のステータス
- **ローカル開発**: ✅ 完了
- **コア機能**: ✅ 動作確認済み  
- **フォーマット保持**: ✅ **新規実装完了** ⭐
- **DOCXダウンロード**: ✅ **新規実装完了** ⭐
- **UI/UX**: ✅ 実装済み
- **本格デプロイ**: 🔄 準備中

## 実装されていない機能
- オンライン永続化（ファイル保存）
- ユーザー認証システム
- 複数ファイル同時処理
- カスタム校正ルール追加
- Excel/PowerPointファイルサポート

## 推奨される次のステップ
1. Vercel/Railwayでの本格デプロイ
2. GitHub Pagesでの静的ホスティング（フロントエンドのみ）
3. API分離でのマイクロサービス化
4. 校正ルールのカスタマイズ機能追加
5. PowerPointファイル対応の追加

## 🎯 主要な改善点（v1.1.0）
- ✅ **完全なフォーマット保持**: 表構造、スタイル、レイアウトを完全に保持
- ✅ **DOCXダウンロード機能**: 校正後のDOCXファイルをワンクリックでダウンロード
- ✅ **XMLレベル校正**: 元のDOCX構造を維持しながらテキストのみを校正
- ✅ **ファイル名自動生成**: 「元ファイル名_校正済み.docx」形式で自動命名
- ✅ **ユーザビリティ向上**: ダウンロードボタンの追加とUI改善

## 最終更新
- **日付**: 2024-09-08  
- **バージョン**: 1.1.0
- **ステータス**: フォーマット保持DOCX ダウンロード機能完全実装
- **テスト済み**: トンガ王国大使セレモニー文書（437KB、6表、151段落）で動作確認完了