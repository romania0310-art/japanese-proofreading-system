# 学校現場情報共有システム - 要件定義書

## プロジェクト概要

### 目的
学校現場の多忙な環境において、各担当者間（児童支援担当教諭、養護教諭、ICT支援員、国際教室担当等）での情報共有を迅速・確実・安全に行うためのWebアプリケーションシステム

### 主要機能
1. **音声入力による情報入力**
   - スマートフォン・タブレット対応
   - Web Speech API による音声認識
   - 入力内容のリアルタイム変換・確認

2. **情報管理機能**
   - 入力者識別
   - 共有先指定
   - タイムスタンプ自動付与
   - 秘匿レベル分類

3. **管理機能**
   - 入力者・共有先の管理画面
   - アクセス権限設定
   - データ閲覧・編集・削除権限

## 機能要件

### 1. 音声入力システム
- **対応デバイス**: iOS Safari, Android Chrome, デスクトップブラウザ
- **音声認識**: Web Speech API (継続的音声認識対応)
- **言語**: 日本語（ja-JP）
- **入力制限**: 最大5分間の連続録音
- **フォールバック**: 音声認識不可時のテキスト入力

### 2. ユーザー管理
#### 入力者カテゴリ
- 児童支援担当教諭
- 養護教諭
- ICT支援員
- 国際教室担当
- 管理職
- その他（カスタマイズ可能）

#### 共有先カテゴリ
- 個人指定
- 役職グループ指定
- 全体共有
- 緊急時全員通知

### 3. セキュリティ要件
#### 秘匿レベル
- **レベル1（一般）**: 通常の業務連絡
- **レベル2（注意）**: 個人情報を含む内容
- **レベル3（機密）**: 高度な秘匿性が必要な内容

#### アクセス制御
- JWT による認証
- 役職ベースのアクセス制御（RBAC）
- 秘匿レベルに応じたアクセス制限
- セッション管理・自動ログアウト

#### データ保護
- エンドツーエンド暗号化（AES-256）
- データベース暗号化
- 通信暗号化（HTTPS必須）
- ログアクセス監査

### 4. データ管理
#### メッセージデータ構造
```json
{
  "id": "uuid",
  "sender_id": "入力者ID",
  "recipients": ["共有先ID配列"],
  "content": "暗号化されたメッセージ内容",
  "confidentiality_level": "1-3",
  "timestamp": "ISO8601形式",
  "audio_duration": "秒数",
  "is_urgent": "緊急フラグ",
  "read_status": "既読状況",
  "metadata": {
    "device_type": "デバイス種別",
    "location": "送信場所（任意）"
  }
}
```

## 技術要件

### フロントエンド
- **フレームワーク**: React.js + TypeScript
- **UI/UX**: Material-UI または Tailwind CSS
- **PWA対応**: オフライン利用・プッシュ通知
- **レスポンシブデザイン**: モバイルファースト

### バックエンド
- **フレームワーク**: Node.js + Express
- **データベース**: PostgreSQL + Prisma ORM
- **認証**: JWT + bcrypt
- **リアルタイム通信**: Socket.io
- **ファイルストレージ**: 音声ファイル一時保存用

### インフラ・デプロイ
- **クラウド**: Vercel（フロント） + Railway/Render（バック）
- **データベース**: PostgreSQL (Railway/Render)
- **CDN**: 静的ファイル配信
- **SSL/TLS**: 全通信暗号化

## 非機能要件

### パフォーマンス
- **レスポンス時間**: 3秒以内
- **音声認識精度**: 85%以上
- **同時接続**: 100ユーザー
- **データ保存期間**: 1年間（設定可能）

### 可用性
- **稼働率**: 99.5%以上
- **メンテナンス時間**: 月次2時間以内
- **バックアップ**: 日次自動バックアップ

### セキュリティ
- **認証**: 二要素認証推奨
- **監査ログ**: 全アクセス記録
- **データ暗号化**: 保存時・転送時ともに暗号化
- **脆弱性対策**: 定期的セキュリティ監査

## ユーザーストーリー

### メッセージ送信者
1. スマートフォンでアプリにアクセス
2. 音声入力ボタンを押して情報を録音
3. 共有先を選択（個人/グループ）
4. 秘匿レベルを設定
5. 送信確認後、メッセージ配信

### メッセージ受信者
1. プッシュ通知でメッセージ受信を確認
2. アプリにログインして内容確認
3. 必要に応じて返信・転送
4. 既読マーク付与

### 管理者
1. 管理画面でユーザー管理
2. 入力者・共有先設定の変更
3. セキュリティ設定・監査ログ確認
4. システム利用状況のモニタリング

## 実装優先順位

### Phase 1（MVP - 最小限実行可能プロダクト）
1. ✅ 基本認証システム
2. ✅ 音声入力・テキスト変換
3. ✅ メッセージ送受信
4. ✅ 基本的な管理画面

### Phase 2（セキュリティ強化）
1. ✅ 暗号化実装
2. ✅ 秘匿レベル管理
3. ✅ アクセス制御強化
4. ✅ 監査ログ機能

### Phase 3（機能拡張）
1. ⏳ プッシュ通知
2. ⏳ PWA対応
3. ⏳ 詳細検索・フィルタ
4. ⏳ データ分析・レポート

## 制約事項・リスク

### 技術的制約
- Web Speech API のブラウザサポート限定
- 音声認識精度の環境依存性
- ネットワーク接続が必要

### セキュリティリスク
- 音声データの一時的な平文保存
- ブラウザセキュリティ依存性
- 端末紛失時のデータアクセス

### 運用リスク
- 学校ネットワークのファイアウォール制限
- デバイスのマイクアクセス許可設定
- ユーザーのITリテラシー依存

## 成功指標（KPI）

### 利用率
- 月間アクティブユーザー: 80%以上
- 日次メッセージ送信数: 平均20件以上
- 音声入力利用率: 70%以上

### 効率性
- 情報共有時間短縮: 従来比50%減
- レスポンス時間: 24時間以内から1時間以内へ
- システム満足度: 4.0/5.0以上

---

**作成日**: 2024-10-16  
**バージョン**: 1.0  
**ステータス**: 初版作成完了